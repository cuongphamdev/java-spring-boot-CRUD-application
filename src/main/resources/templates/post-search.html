<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8" />
    <title>Search</title>
    <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
            integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
            crossorigin="anonymous"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.11/dist/css/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />
</head>
<body>
<header th:replace="header.html :: header"> </header>
<div class="container">
    <section class="user-search">
        <form action="#" method="GET" class="search-user-form">
            <div class="form-group d-flex">
                <input
                        type="text"
                        class="form-search-user-input"
                        id="search-user-input"
                        placeholder="Enter the post title, content"
                        name="q"
                        th:attr="value=${searchPostData.searchQuery != null ? searchPostData.searchQuery : ''}"
                />
            </div>
            <div class="form-group flex-direct--y">
                <div class="form-group">
                    <label class="form-label">Sort by</label>
                    <select name="sortBy" class="selectpicker form-select" data-live-search="true" multiple data-max-options="1" data-size="5">
                        <option value="a2z" class="form-option" th:attr="selected=${searchPostData.sortBy == 'a2z' ? 'selected' : 'false' }">A to Z</option>
                        <option value="z2a" class="form-option" th:attr="selected=${searchPostData.sortBy == 'z2a' ? 'selected' : 'false' }">Z to A</option>
                        <option value="latestPost" class="form-option" th:attr="selected=${searchPostData.sortBy == 'latestPost' ? 'selected' : 'false' }">Latest Post</option>
                        <option value="commentDESC" class="form-option" th:attr="selected=${searchPostData.sortBy == 'commentDESC' ? 'selected' : 'false' }">Count Comment</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Pick tag</label>
                    <select name="tagId" class="selectpicker form-select" data-live-search="true" multiple data-max-options="1" data-size="5">
                        <option th:attr="value=${tag.id}, selected=${searchPostData.anotherDataId == tag.id ? 'selected' : 'false' }" th:text="${tag.name}" th:if="${tags != null}" th:each="tag : ${tags}">Tag name</option>
                    </select>
                </div>
                <div class="form-group">
                <label class="form-label">Number in page</label>
                <select name="break" class="selectpicker form-select" data-live-search="true" multiple data-max-options="1" data-size="5">
                    <option th:attr="value=${number}, selected=${searchPostData.pageBreak == number ? 'selected' : 'false' }" th:each="number: ${#numbers.sequence(5, 20, 5)}" th:text="${number + ' per page'}"></option>
                </select>
            </div>
            </div>
            <div class="form-group flex-x--end">
                <button class="btn btn-default btn-success" type="submit">Search</button>
            </div>
        </form>
    </section>
    <section class="list-all-posts" th:if="${searchPostData != null}">
        <dib class="post-lists" th:if="${searchPostData.listItems != null}">
            <p class="post" th:if="${searchPostData.listItems.size() == 0}">
                No data
            </p>
            <div class="post-lists" th:if="${searchPostData != null}">
                <div
                        class="post"
                        th:attr="id=${'post-' + post.id}"
                        th:each="post : ${searchPostData.listItems}"
                >
                    <div class="title-header">
                        <div class="title-header-left">
                            <h5 class="author" th:text="${post.user.name}">Author</h5>
                            <p class="created-at" th:text="${post.createdAt}">
                                16/2/2018
                            </p>
                            <p th:if="${post.tags != null}"  class="created-at">
                                <span th:each="tag: ${post.tags}" th:text="${'  #' + tag.name}">tag</span>
                            </p>
                        </div>
                        <div
                                class="title-header-right"
                                th:attr="post-id=${post.id}"
                                post-id="1"
                        >
                <span
                        th:if="${session.loginSession != null && session.loginSession.id == post.user.id}"
                        id="action-more-btn"
                >â–¼</span
                >
                        </div>
                    </div>
                    <h3 class="title" id="title" th:text="${post.title}">
                        This is title
                        >
                    </h3>
                    <div id="content" class="content" th:text="${post.content}">
                    </div>
                    <div class="post-footer">
                        <strong th:text="${post.comments.size()}"></strong>
                        <span th:text="${post.comments.size() > 1 ? ' comments' : ' comment'}"></span>
                        <br>
                        <a th:href="@{'/posts/' + ${post.id}}">View detail</a>
                    </div>
                    <div
                            class="popup"
                            id="popup"
                            th:if="${session.loginSession != null && session.loginSession.id == post.user.id}"
                    >
                        <ul class="list-action" id="list-action">
                            <span class="inner" id="inner">X</span>
                            <li
                                    class="action"
                                    id="update-post"
                                    th:attr="post-id=${post.id}"
                            >
                                Update
                            </li>
                            <li
                                    class="action"
                                    id="remove-post"
                                    th:attr="post-id=${post.id}"
                            >
                                Remove
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </dib>
        <div class="pagination" th:if="${searchPostData.maxPages > 1}">
            <br>
            <p th:text="${'Display ' + searchPostData.listItems.size() + ' of ' + searchPostData.totalItems + (searchPostData.listItems.size() > 1 ? ' items' : ' item')}"></p>
            <ul class="pagination-list" id="pagination-list">
                <li
                        class="post pagination-item"
                        th:each="number: ${#numbers.sequence(1, searchPostData.maxPages, 1)}"
                >
                    <a
                            th:href="@{'/search/post?q=' + ${searchPostData.searchQuery} +
                            '&sortBy=' + ${searchPostData.sortBy} +
                            '&page=' + ${number} +
                            '&break=' + ${searchPostData.pageBreak} +
                            '&nameUser=' + ${searchPostData.anotherQuery} +
                            '&tagId=' + ${searchPostData.anotherDataId}}" th:text="${number}"
                    ></a>
                </li>
            </ul>
        </div>
    </section>
    <section class="modal" id="modal-update" >
        <form  th:if="${session.loginSession != null}" id="update-post-form"  class="form create-post">
     <span class="form-title">
       Update a post
    </span>
            <input type="text" name="title" id="update-post-title" class="input input--fullwidth" placeholder="Enter the title of your post">
            <input type="hidden" name="postId" id="update-post-id">
            <div class="post-content">
      <textarea class="textarea" id="update-post-content" name="content">
</textarea>
            </div>
            <div class="form-footer">
                <button class="btn btn-primary" id="post-update-submit" type="button">
                    Update
                </button>
            </div>
        </form>
        <button class="btn btn--full btn-warning" id="close-update-modal">Close</button>
    </section>
</div>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"
></script>
<script
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"
></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.11/dist/js/bootstrap-select.min.js"></script>
<script th:src="@{/js/main.js}"></script>
</body>
</html>
